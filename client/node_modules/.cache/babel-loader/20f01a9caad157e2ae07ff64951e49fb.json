{"ast":null,"code":"import _defineProperty from\"C:\\\\Users\\\\gibran\\\\github\\\\projects\\\\realtime-document-editor\\\\client\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly)symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(source,true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(source).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import React,{useEffect}from\"react\";import{useSelector,useDispatch,shallowEqual}from\"react-redux\";import{w3cwebsocket as W3CWebSocket}from\"websocket\";import{Navbar,NavbarBrand}from\"reactstrap\";import\"./App.css\";import ShowEditorSection from\"./components/EditorContainer\";import ShowLoginSection from\"./components/LogInContainer\";import{websocket}from\"./redux\";import{client}from\"./redux\";import{userActivity,currentUsers,text}from\"./redux\";var App=function App(){var dispatch=useDispatch();var contentDefaultMessage=[\"Start writing your document here\"];var state=useSelector(function(state){return state;},shallowEqual);useEffect(function(){var clients=new W3CWebSocket();clients.onopen=function(){console.log(\"WebSocket Client Connected\");dispatch(client({client:clients}));dispatch(websocket({websocketConnected:true}));};},[dispatch]);useEffect(function(){if(!state.logInReducer)return;state.clientReducer.client.onmessage=function(message){var dataFromServer=JSON.parse(message.data);var stateToChange={};if(dataFromServer.type===\"userevent\"){if(dataFromServer.data.editorContent){stateToChange.currentUsers=Object.values(dataFromServer.data.users);stateToChange.text=[dataFromServer.data.editorContent];}else{stateToChange.currentUsers=Object.values(dataFromServer.data.users);stateToChange.text=state.textReducer.length?[state.textReducer]:contentDefaultMessage;}}else if(dataFromServer.type===\"contentchange\"){stateToChange.text=[dataFromServer.data.editorContent]||contentDefaultMessage;return dispatch(text(_objectSpread({},stateToChange.text)));}stateToChange.userActivity=dataFromServer.data.userActivity;dispatch(currentUsers(_objectSpread({},stateToChange.currentUsers)));dispatch(userActivity(_objectSpread({},stateToChange.userActivity)));dispatch(text(_objectSpread({},stateToChange.text)));};});return React.createElement(React.Fragment,null,React.createElement(Navbar,{color:\"light\",light:true},state.logInReducer!=null?React.createElement(NavbarBrand,{href:\"/\"},\"Exit document editor\"):React.createElement(NavbarBrand,{href:\"/\"},\"Real-time document editor\")),React.createElement(\"div\",{className:\"container-fluid\"},state.logInReducer!=null?React.createElement(ShowEditorSection,null):React.createElement(ShowLoginSection,null)));};export default App;","map":{"version":3,"sources":["C:/Users/gibran/github/projects/realtime-document-editor/client/src/App.js"],"names":["React","useEffect","useSelector","useDispatch","shallowEqual","w3cwebsocket","W3CWebSocket","Navbar","NavbarBrand","ShowEditorSection","ShowLoginSection","websocket","client","userActivity","currentUsers","text","App","dispatch","contentDefaultMessage","state","clients","onopen","console","log","websocketConnected","logInReducer","clientReducer","onmessage","message","dataFromServer","JSON","parse","data","stateToChange","type","editorContent","Object","values","users","textReducer","length"],"mappings":"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","sourcesContent":["import React, { useEffect } from \"react\";\r\nimport { useSelector, useDispatch, shallowEqual } from \"react-redux\";\r\nimport { w3cwebsocket as W3CWebSocket } from \"websocket\";\r\nimport { Navbar, NavbarBrand } from \"reactstrap\";\r\nimport \"./App.css\";\r\nimport ShowEditorSection from \"./components/EditorContainer\";\r\nimport ShowLoginSection from \"./components/LogInContainer\";\r\nimport { websocket } from \"./redux\";\r\nimport { client } from \"./redux\";\r\nimport { userActivity, currentUsers, text } from \"./redux\";\r\n\r\nconst App = () => {\r\n  const dispatch = useDispatch();\r\n  const contentDefaultMessage = [\"Start writing your document here\"];\r\n  const state = useSelector(state => state, shallowEqual);\r\n\r\n  useEffect(() => {\r\n    const clients = new W3CWebSocket();\r\n    clients.onopen = () => {\r\n      console.log(\"WebSocket Client Connected\");\r\n      dispatch(client({ client: clients }));\r\n      dispatch(websocket({ websocketConnected: true }));\r\n    };\r\n  }, [dispatch]);\r\n\r\n  useEffect(() => {\r\n    if (!state.logInReducer) return;\r\n    state.clientReducer.client.onmessage = message => {\r\n      const dataFromServer = JSON.parse(message.data);\r\n      const stateToChange = {};\r\n      if (dataFromServer.type === \"userevent\") {\r\n        if (dataFromServer.data.editorContent) {\r\n          stateToChange.currentUsers = Object.values(dataFromServer.data.users);\r\n          stateToChange.text = [dataFromServer.data.editorContent];\r\n        } else {\r\n          stateToChange.currentUsers = Object.values(dataFromServer.data.users);\r\n          stateToChange.text = state.textReducer.length\r\n            ? [state.textReducer]\r\n            : contentDefaultMessage;\r\n        }\r\n      } else if (dataFromServer.type === \"contentchange\") {\r\n        stateToChange.text =\r\n          [dataFromServer.data.editorContent] || contentDefaultMessage;\r\n        return dispatch(text({ ...stateToChange.text }));\r\n      }\r\n      stateToChange.userActivity = dataFromServer.data.userActivity;\r\n      dispatch(currentUsers({ ...stateToChange.currentUsers }));\r\n      dispatch(userActivity({ ...stateToChange.userActivity }));\r\n      dispatch(text({ ...stateToChange.text }));\r\n    };\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <Navbar color=\"light\" light>\r\n        {state.logInReducer != null ? (\r\n          <NavbarBrand href=\"/\">Exit document editor</NavbarBrand>\r\n        ) : (\r\n          <NavbarBrand href=\"/\">Real-time document editor</NavbarBrand>\r\n        )}\r\n      </Navbar>\r\n      <div className=\"container-fluid\">\r\n        {state.logInReducer != null ? (\r\n          <ShowEditorSection />\r\n        ) : (\r\n          <ShowLoginSection />\r\n        )}\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default App;\r\n"]},"metadata":{},"sourceType":"module"}